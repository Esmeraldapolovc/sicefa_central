
///objetos
let sucursales = [
    {
        "id": "1",
        "nombreDeLaSucursal": "Medicamos tu vida S.A",
        "nombreDelTitular": "polo",
        "rfc": "TODJ040626TVA",
        "domicilio": "Privada los pinos no.10",
        "colonia": "",
        "estado": "Gua",
        "ciudad": "Leon",
        "codigoPostal": "0236",
        "telefono": 4776352347,
        "longitud": "19°11'57.89 N",
        "latitud": "16°13'43.57S",
        "status": "1",

        "empleados":
                {
                    "id": "",
                    "clave": "",
                    "email": "",
                    "fechaContratacion": "",
                    "puesto": "administrador",
                    "salarioBruto": "",
                    "estatus": 1,
                    "Persona":
                            {
                                "id": "",
                                "nombre": "",
                                "apellidopaterno": "",
                                "apellidoMaterno": "",
                                "genero": "",
                                "rfc": "",
                                "curp": "",
                                "fechadenacimiento": "",
                                "foto": "",
                                "domicilio": "",
                                "codigoPostal": "",
                                "ciudad": "",
                                "estado": "",
                                "telefono": ""
                            },
                    "usuario": {
                        "id": 7,
                        "nombreUsuario": "Admins1",
                        "contrasenia": "utlsecret#",
                        "rol": "ADMS"
                    }



                }
    },

    {
        "id": "2",
        "nombreDeLaSucursal": "Medicamos tu vida S.A",
        "nombreDelTitular": "Azul",
        "rfc": "TODA040626TVA",
        "domicilio": "Portal Bravo 2 418, esquina con Benito Juárez",
        "colonia": "centro",
        "estado": "BS",
        "ciudad": "Leon",
        "codigoPostal": "0236",
        "telefono": 4776352347,
        "longitud": "19°11'57.89 N",
        "latitud": "16°13'43.57S",
        "status": "1",
        
        "empleados": {
        "id": "",
        "clave": "",
        "email": "",
        "fechaContratacion": "",
        "puesto": "",
        "salarioBruto": "",
        "estatus": "",

        "persona": {
            "id":"",
            "nombre": "",
            "apellidopaterno": "",
            "apellidoMaterno": "",
            "genero": "",
            "rfc": "",
            "curp": "",
            "fechadenacimiento": "",
            "foto": "",
            "domicilio": "",
            "codigoPostal": "",
            "ciudad": "",
            "estado": "",
            "telefono": ""
        },
        "usuario": {
            "id": "",
            "nombreUsuario": "Admins2",
            "contrasenia": "utlsecret#",
            "rol": "ADMS"
        }
    }
    },

    {
        "id": "3",
        "nombreDeLaSucursal": "Medicamos tu vida S.A",
        "nombreDelTitular": "Azul",
        "rfc": "TODA040626TVA",
        "domicilio": "Jardines de Jerez, 37530 León, Gto.",
        "colonia": "Adolfo lopóz Mateo",
        "estado": "Ag",
        "ciudad": "Leon",
        "codigoPostal": "0236",
        "telefono": 4776352347,
        "longitud": "19°11'57.89 N",
        "latitud": "16°13'43.57S",
        "status": "1",
         "empleados": {
        "id": "",
        "clave": "",
        "email": "",
        "fechaContratacion": "",
        "puesto": "",
        "salarioBruto": "",
        "estatus": "",

        "persona": {
            "id":"",
            "nombre": "",
            "apellidopaterno": "",
            "apellidoMaterno": "",
            "genero": "",
            "rfc": "",
            "curp": "",
            "fechadenacimiento": "",
            "foto": "",
            "domicilio": "",
            "codigoPostal": "",
            "ciudad": "",
            "estado": "",
            "telefono": ""
        },
        "usuario": {
            "id": "",
            "nombreUsuario": "Admins3",
            "contrasenia": "utlsecret#",
            "rol": "ADMS"
        }
     }
    },
    {
        "id": "4",
        "nombreDeLaSucursal": "Medicamos tu vida S.A",
        "nombreDelTitular": "Azul",
        "rfc": "TODA040626TVA",
        "domicilio": "Boulevard Juan Alonso de Torres, León, Mexico ",
        "colonia": "ssddd",
        "ciudad": "Leon",
        "estado": "Hi",
        "codigoPostal": "0236",
        "telefono": 4776352347,
        "longitud": "19°11'57.89 N",
        "latitud": "16°13'43.57S",
        "status": "1",
        
         "empleados": {
        "id": "",
        "clave": "",
        "email": "",
        "fechaContratacion": "",
        "puesto": "",
        "salarioBruto": "",
        "estatus": "",

        "persona": {
            "id":"",
            "nombre": "",
            "apellidopaterno": "",
            "apellidoMaterno": "",
            "genero": "",
            "rfc": "",
            "curp": "",
            "fechadenacimiento": "",
            "foto": "",
            "domicilio": "",
            "codigoPostal": "",
            "ciudad": "",
            "estado": "",
            "telefono": ""
        },
        "usuario": {
            "id": "",
            "nombreUsuario": "Admins4",
            "contrasenia": "utlsecret#",
            "rol": "ADMS"
        }
    }
    },

    {
        "id": "5",
        "nombreDeLaSucursal": "Medicamos tu vida S.A",
        "nombreDelTitular": "Azul",
        "rfc": "TODA040626TVA",
        "domicilio": "adsdsd",
        "colonia": "sasssd",
        "ciudad": "Leon",
        "estado": "Ja",
        "codigoPostal": "0236",
        "telefono": 4776352347,
        "longitud": "19°11'57.89 N",
        "latitud": "16°13'43.57S",
        "status": "1",
        
         "empleados": {
        "id": "",
        "clave": "",
        "email": "",
        "fechaContratacion": "",
        "puesto": "",
        "salarioBruto": "",
        "estatus": "",

        "persona": {
            "id":"",
            "nombre": "",
            "apellidopaterno": "",
            "apellidoMaterno": "",
            "genero": "",
            "rfc": "",
            "curp": "",
            "fechadenacimiento": "",
            "foto": "",
            "domicilio": "",
            "codigoPostal": "",
            "ciudad": "",
            "estado": "",
            "telefono": ""
        },
        "usuario": {
            "id": "",
            "nombreUsuario": "Admins5",
            "contrasenia": "utlsecret#",
            "rol": "ADMS"
        }
    }
    }
];



///////////////////////FUNCIONES 
export function inicializar() {
    setDetallesSucursalVisible(false);
    fillTableSucursal();
}

//insert y update en el mismo metodo
export function save()
{

//Declara un objeto donde se guardaran los datos de la Sucursal
    let su = null;
    let posicion = -1; // para saber si una sucursal ya existe o no.
    let idSucursal = 0;
//Revisamos si hay un id Sucursal

    if (document.getElementById("txtId").value.trim().length > 0) //trim quita espacios de isquierda o derecha
    {
        idSucursal = parseInt(document.getElementById("txtId").value.trim());
        posicion = buscarPosicionSucursal(idSucursal);

        //Si posicion es mayor o igual a 0, si encontramos a la sucursal:

        if (posicion >= 0)
            su = sucursales[posicion];
        else
        {
            //Si no hay un empleado con el ID descrito
            //creamos una nueva instancia del objeto

            su = new Object();
            su.id = idSucursal;

            //incerta el objeto su del arreglo empleado:

            sucursales.push(su);
        }



        su.id = document.getElementById("txtId").value;
        su.nombreDeLaSucursal = document.getElementById("txtNombreSucursal").value;
        su.nombreDelTitular = document.getElementById("txtNombredelapersonatitular").value;
        su.rfc = document.getElementById("txtrfc").value;
        su.domicilio = document.getElementById("domicilio").value;
        su.colonia = document.getElementById("colonia").value;
        su.estado = document.getElementById("cmbEstado").value;
        su.codigoPostal = document.getElementById("txtcodigoPostal").value;
        su.telefono = document.getElementById("txtTelefono").value;
        su.longitud = document.getElementById("txtlongitud").value;
        su.latitud = document.getElementById("txtlatitud").value;
        su.status = document.getElementById("txtStatus").value;
        su.ciudad = document.getElementById("txtCiudad").value;

        //Refrescar la tabla
        fillTableSucursal();

        Swal.fire('Movimiento Realizado', 'Datos de Sucursal Actualizados correctamente', 'success');

    } else
    {
        swal.fire('verificaci&oacute;n de datos requerida',
                'Deve de agregar el ID a la sucursal (Valor num&eacute;rico)', 'warning');
    }
}

export function deleteSucursal()
{

    let posicion = -1;
    let idSucursal = 0;

//Revisa si hay un id de empleado
    if (document.getElementById("txtId").value.trim().length > 0) {

        //Recuperamos el Id de la sucursal que deseamos Eliminar
        idSucursal = document.getElementById("txtId").value.trim();

        //Buscamos la posicion del la sucurdal con ese ID
        posicion = buscarPosicionSucursal(idSucursal);

        //Si la posicion del empleado con eae ID

        if (posicion >= 0) {
            sucursales.splice(posicion, 1);
            Swal.fire('movimiento realizado.', 'Registro de Sucursales Eliminado', 'success');
            fillTableSucursal();
        } else
        {
            Swal.fire('', 'El ID de la Sucursal especificada no existe', 'warning');
        }
    } else
    {
        Swal.fire('Verificaci&oacute;n de datos requerida.',
                'Debe agregar un ID a la Sucursal (valor num&eacute;rico).',
                'warning');
    }
}




export function getSucursal()
{

}

//llena la tabla de Empleados.
//Con el arreglo.
function fillTableSucursal()
{
    //Aqui vamos a guardar el contenido de la tabla del
    //tbody  de la tabla de sucursales
    let contenido = '';

    //Recorrer el araglo elemento por elemento
    for (let i = 0; i < sucursales.length; i++)
    {
        contenido += '<tr>' +
                '<td>' +
                sucursales[i].nombreDeLaSucursal +
                '</td>' +
                '<td>' +
                sucursales[i].domicilio +
                '</td>' +
                '<td>' +
                sucursales[i].colonia +
                '</td>' +
                '<td>' +
                sucursales[i].ciudad +
                '</td>' +
                '<td>' +
                sucursales[i].telefono +
                '</td>' +
                '<td>' +
                '<a href="#" class=text-info onclick="cm.cargarDetalleSucursal(' + i + ');"> <i class="fa fa-circle-info"></i></a>' +
                '</td>' +
                '</tr>';


    }
    document.getElementById("tbodySucursales").innerHTML = contenido;
}


export function cargarDetalleSucursal(posicion)
{
    //Recuperando la Sucursal en la posicion indicada

    let su = sucursales[posicion];

    //Llenamos la caja de texto y demas controles con datos de
    //la sucursal que recuperamos previamente

    document.getElementById("txtId").value = su.id;
    document.getElementById("txtNombreSucursal").value = su.nombreDeLaSucursal;
    document.getElementById("txtNombredelapersonatitular").value = su.nombreDelTitular;
    document.getElementById("txtrfc").value = su.rfc;
    document.getElementById("domicilio").value = su.domicilio;
    document.getElementById("colonia").value = su.colonia;
    document.getElementById("cmbEstado").value = su.estado;
    document.getElementById("txtcodigoPostal").value = su.codigoPostal;
    document.getElementById("txtTelefono").value = su.telefono;
    document.getElementById("txtlongitud").value = su.longitud;
    document.getElementById("txtlatitud").value = su.latitud;
    document.getElementById("txtStatus").value = su.status;
    document.getElementById("txtCiudad").value = su.ciudad;

    setDetallesSucursalVisible(true);
}

export function clearForm()
{
    //Datos de sucursal
    document.getElementById("txtId").value = '';
    document.getElementById("txtNombreSucursal").value = '';
    document.getElementById("txtNombredelapersonatitular").value = '';
    document.getElementById("txtrfc").value = '';
    document.getElementById("domicilio").value = '';
    document.getElementById("colonia").value = '';
    document.getElementById("cmbEstado").value = '';
    document.getElementById("txtcodigoPostal").value = '';
    document.getElementById("txtTelefono").value = '';
    document.getElementById("txtlongitud").value = '';
    document.getElementById("txtlatitud").value = '';
    document.getElementById("txtStatus").value = '';
    document.getElementById("txtCiudad").value = '';
}

function buscarPosicionSucursal(idSucursal)
{
    for (let i = 0;
    i < sucursales.length; i++)
    {
        if (sucursales[i].id === idSucursal)
            return i;
    }

    return -1;
}


export function setDetallesSucursalVisible(valor)
{
    if (valor === true)
    {
        //Ocultar la seccion de  catalogos de empleados
        document.getElementById("divCatalogoSucursal").style.display = 'none';

        ///Mostrar la seccion de detalles 
        document.getElementById("divDetalleSucursal").style.display = '';
    } else
    {

        //Ocultar la seccion de  catalogos de empleados
        document.getElementById("divDetalleSucursal").style.display = 'none';

        ///Mostrar la seccion de detalles 
        document.getElementById("divCatalogoSucursal").style.display = '';
    }

}

export function clearAndShowDetalleSucursal()
{

    clearForm();
    setDetallesSucursalVisible(true);


}


